==========
Nginx Role
==========

Tasks
=====

* Installs Nginx server.
* Configures virtual hosts with static content.


Variables
=========

+-----------------------------------------+----------+---------+------------------------------------------------+
| Variable                                | Required | Default | Description                                    |
+=========================================+==========+=========+================================================+
| ``nginx_default_redirect_url``          | no       |         | Sets redirect URL for ``default_server``.      |
+-----------------------------------------+----------+---------+------------------------------------------------+
| ``nginx_sendfile``                      | no       | ``on``  | Enables sendfile.                              |
+-----------------------------------------+----------+---------+------------------------------------------------+
| ``nginx_server_names_hash_bucket_size`` | no       |         | Sets ``server_names_hash_bucket_size``.        |
+-----------------------------------------+----------+---------+------------------------------------------------+
| ``nginx_static_servers``                | no       | ``[]``  | List of static servers. See `Static servers`_. |
+-----------------------------------------+----------+---------+------------------------------------------------+

Static servers
--------------

+-----------------+-----------------------------------+-------------------------------------------------------------+
| Key             | Required                          | Description                                                 |
+=================+===================================+=============================================================+
| ``server_name`` | yes                               | Nginx server name. Mustn't include wildcards.               |
+-----------------+-----------------------------------+-------------------------------------------------------------+
| ``ssl``         | yes                               | ``no``                                                      |
|                 |                                   |   disables HTTPS.                                           |
|                 |                                   | ``yes``                                                     |
|                 |                                   |   enables both HTTP and HTTPS servers.                      |
|                 |                                   | ``only``                                                    |
|                 |                                   |   enables HTTPS; HTTP server will redirect to HTTPS server. |
+-----------------+-----------------------------------+-------------------------------------------------------------+
| ``ssl_cert``    | if ``ssl`` is ``yes`` or ``only`` | Absolute path to chained SSL certificate.                   |
+-----------------+-----------------------------------+-------------------------------------------------------------+
| ``ssl_key``     | if ``ssl`` is ``yes`` or ``only`` | Absolute path to SSL private key.                           |
+-----------------+-----------------------------------+-------------------------------------------------------------+
| ``sync``        | yes                               | List of hashes to rsync between local and remote machines:  |
|                 |                                   | ``src``                                                     |
|                 |                                   |   Local path to static content                              |
|                 |                                   | ``dest``                                                    |
|                 |                                   |   Path on remote machine relative to server root            |
+-----------------+-----------------------------------+-------------------------------------------------------------+
| ``add_www``     | no                                | Add www subdomain redirecting to ``server_name``            |
+-----------------+-----------------------------------+-------------------------------------------------------------+
| ``index``       | no                                | Index file name. If not specified index will be disabled.   |
+-----------------+-----------------------------------+-------------------------------------------------------------+
| ``autoindex``   | no                                | Enables autoindex.                                          |
+-----------------+-----------------------------------+-------------------------------------------------------------+
| ``expires``     | no                                | Value of nginx ``expires`` parameter.                       |
+-----------------+-----------------------------------+-------------------------------------------------------------+

